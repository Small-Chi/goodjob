<!-- controllers -->

// 未登入使用者抓指定人公開的
export const getTracks = async (req, res) => {
try {
const result = await tracks.find({ artist: req.query.artist, private: false })
res.status(200).send({ success: true, message: '', result })
} catch (error) {
res.status(500).send({ success: false, message: '伺服器錯誤' })
}
}

// 使用者取自己所有的音樂
export const getPrivate = async (req, res) => {
try {
const result = await tracks.find({ artist: req.user.id })
res.status(200).send({ success: true, message: '', result })
} catch (error) {
res.status(500).send({ success: false, message: '伺服器錯誤' })
}
}

<!-- routes -->

import express from 'express'
// 驗證資料格式的 middleware
import content from '../middleware/content.js'
import auth from '../middleware/auth.js'
import upload from '../middleware/upload.js'
import admin from '../middleware/admin.js'

import {
create,
getTracks,
getAllTracks,
getTrackById,
updateTrackById,
deleteTrack,
editTracks,
getPrivate,
postComment
} from '../controllers/tracks.js'
const router = express.Router()

router.post('/', auth, content('multipart/form-data'), upload, create)
router.get('/', getTracks)
router.get('/private/:id', auth, getPrivate)
router.get('/all', auth, admin, getAllTracks)
router.get('/:id', getTrackById)
router.patch('/:id', auth, content('multipart/form-data'), upload, updateTrackById)
// 管理員修改使用者資料
router.patch('/admin/:id', auth, editTracks)
router.patch('/comment/:id', auth, content('application/json'), postComment)
router.delete('/:id', auth, deleteTrack)

export default router

<!-- 頁面  views/back/Mytracks.vue-->

async getUserTracks () {
try {
const { data } = await this.api.get('/tracks?artist=' + this.$route.params.id)
        this.userTracks = data.result
      } catch (error) {
        this.$swal({
icon: 'error',
title: '錯誤',
text: '取得音樂失敗'
})
}
},
async getPrivate () {
try {
const { data } = await this.api.get('/tracks/private/' + this.user.\_id, {
headers: {
authorization: 'Bearer ' + this.user.token
}
})
this.userTracks = data.result
} catch (error) {
this.$swal({
          icon: 'error',
          title: '錯誤',
          text: '取得音樂失敗'
        })
      }
    }
  },
  async created () {
    if (this.user._id === this.$route.params.id) {
this.getPrivate()
} else {
this.getUserTracks()
}
}
}

<!-- 在前端的  routes 要加上 :id -->

{
path: '/track/:id',
name: 'Track',
// route level code-splitting
// this generates a separate chunk (about.[hash].js) for this route
// which is lazy-loaded when the route is visited.
component: () =>
import(/_ webpackChunkName: "front" _/ '../views/front/SingleTrack.vue'),
meta: {
title: '音樂'
}
